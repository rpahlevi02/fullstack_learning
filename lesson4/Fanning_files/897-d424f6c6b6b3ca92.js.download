"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[897],{45885:function(e,t,n){n.d(t,{Gs:function(){return l},Ni:function(){return s},Ox:function(){return a},a3:function(){return c}});var r=n(74101),o=n(79122),i=n(42787);let a=async(e,t)=>{let n=(0,o.B5)(new URL("".concat(r.publicRuntimeConfig.apiUrl,"user/favorites")),e),a=await (0,i.BB)({url:n,options:{method:"GET",credentials:"same-origin",headers:{authorization:"Token ".concat(t),"Content-Type":"application/json"}}});return await a.json()},c=async(e,t,n,r)=>u(e,t,n,"POST",r),s=async(e,t,n,r)=>u(e,t,n,"DELETE",r),u=async(e,t,n,r,o)=>{let a=await (0,i.BB)({url:d("user/favorites",t,o),options:{method:r,body:"gif_id=".concat(e),headers:{cookie:n,Accept:"application/json",Authorization:"Token ".concat(t),"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"}}});return await a.json()},l=async(e,t,n)=>{let r=await (0,i.BB)({url:d("user/favorites/statuses",t,n),options:{method:"POST",headers:{Authorization:"Token ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({gif_ids:[e]})}});return(await r.json()).data.length>0};function d(e,t,n){let i;let a="".concat(r.publicRuntimeConfig.apiUrl).concat(e);try{i=new URL(a)}catch(e){throw console.error("Invalid URL:",a),e}return(0,o.B5)(i,{api_key:n,access_token:t})}},54747:function(e,t,n){n.d(t,{z:function(){return l}});var r=n(27573),o=n(23042),i=n(57019),a=n(40401),c=n(7653),s=n(78031),u=n(61996);let l=(0,c.createContext)({}),d=()=>((0,u.t)(),null);t.default=e=>{let{children:t,takeover:n,channel:c,hideSearchbar:u,routeName:h}=e;return(0,r.jsx)(a.Z.Provider,{value:{route:h},children:(0,r.jsx)(l.Provider,{value:{hideSearchbar:u},children:(0,r.jsx)(i.d,{channel:c,children:(0,r.jsxs)(o.b.Provider,{value:{takeover:n},children:[(0,r.jsx)(d,{}),(0,r.jsx)(s.Z,{children:t})]})})})})}},78031:function(e,t,n){n.d(t,{x:function(){return L},Z:function(){return G}});var r=n(27573),o=n(40604),i=n(54747),a=n(86393),c=n(23042),s=n(14789),u=n(21447),l=n(79122),d=n(84390),h=n(81899),f=n(23733),p=n(64070),x=n(81695),v=n(7653),g=n(5974),m=n(56522),w=n(43036),k=n(62843),b=n(88223),C=n(14683),y=n(6928),j=n(45874),S=n.n(j),T=n(74101),P=e=>{let{takeover:t}=e,{host:n,pathname:o}=new URL(t.img_src),i="giphy.com"===n?"".concat(T.xj).concat(o):t.img_src;return(0,r.jsx)("a",{href:t.href,target:"_blank",style:{top:10,right:68},className:"absolute hidden cursor-pointer md:block",onClick:()=>{(0,f.u2)({event:"ad_banner_clicked",options:{banner:{bannerName:"searchbar_takeover"}}})},children:(0,r.jsx)("img",{src:i,height:68,width:400,alt:"",onLoad:()=>{(0,f.u2)({event:"ad_banner_viewed",options:{banner:{bannerName:"searchbar_takeover"}}})}})})};let Z=(0,p.default)(()=>Promise.all([n.e(1661),n.e(8146),n.e(3648)]).then(n.bind(n,61270)),{loadableGenerated:{webpack:()=>[61270]}}),_=(0,p.default)(()=>n.e(1206).then(n.bind(n,11206)),{loadableGenerated:{webpack:()=>[11206]}}),I=(0,p.default)(()=>n.e(6750).then(n.bind(n,26750)),{loadableGenerated:{webpack:()=>[26750]}}),R=(0,g.ZP)(h.SearchBar).withConfig({componentId:"sc-ca01e50d-0"})(["input{font-size:22px;padding-left:14px;font-family:",";","}"," .giphy-search-bar-cancel{width:22px;height:22px;margin-right:10px;","}"],S().style.fontFamily,e=>e.$hasTakeover&&(0,g.iv)(["width:","px;flex:unset;"],e.$isStuck?360:540),e=>e.$hasTakeover&&(0,g.iv)(["justify-content:space-between;"]),e=>e.$hasTakeover&&(0,g.iv)(["position:absolute;left:","px;margin:0;"],540)),E=g.ZP.div.withConfig({componentId:"sc-ca01e50d-1"})(["display:none;"," ",""],(0,b.gv)((0,g.iv)(["top:0;display:block;position:absolute;height:","px;display:flex;align-items:center;z-index:",";"],68,k.yV)),e=>{let{$isStuck:t}=e;return t&&(0,b.gv)((0,g.iv)(["position:fixed;top:-70px;transform:translate3d(0,78px,0);transition:transform 0.5s cubic-bezier(0.165,0.84,0.44,1) 0.3s;"]))}),z=g.ZP.div.withConfig({componentId:"sc-ca01e50d-2"})(["padding:5px 0;",""],(0,b.gv)((0,g.iv)(["padding:","px 0 0;"],10))),N=g.ZP.div.withConfig({componentId:"sc-ca01e50d-3"})(["background-color:",";width:100%;z-index:",";position:sticky;top:-1px;"],d.eF,k.u0),B=g.ZP.div.withConfig({componentId:"sc-ca01e50d-4"})(["width:100%;"," ",""],(0,b.gv)((0,g.iv)(["transition:width 0.3s cubic-bezier(0.165,0.84,0.44,1) 0s;margin-left:auto;"])),e=>{let{$isStuck:t}=e;return t&&(0,b.gv)((0,g.iv)(["width:calc(100% - ","px);padding-bottom:8px;"],m.Gc))}),L=(0,v.createContext)({ignoreTarget:"",setIgnoreTarget:()=>{}}),O=e=>{let{isStuck:t}=e,{autoFocus:n}=(0,v.useContext)(u.z),i=(0,o.kx)(),{takeover:a}=(0,v.useContext)(c.b),[s,l]=(0,v.useState)(0),{activeChannel:d}=(0,v.useContext)(h.SearchContext),p=(0,x.useRouter)(),g=(0,v.useCallback)(e=>{if(e){let t=encodeURIComponent((0,C.Kx)(e).replace(/ /g,"-").replace("/",""));if((0,f.u2)({event:"search",options:{searchType:"search",searchTerm:t}}),d){let e="@".concat(d.slug.trim().toLowerCase());p.push("/search/?q=".concat(e,"+").concat(t))}else{let e=i?"gifs"===i?"":"-".concat(i):"";p.push("/search/".concat(t).concat(e))}}},[d,p,i]);return(0,v.useEffect)(()=>{let e=setTimeout(()=>l(0===s?1:0),3e3);return()=>clearTimeout(e)},[s]),(0,r.jsxs)(z,{children:[(0,r.jsx)(R,{$isStuck:t,$hasTakeover:!!a,placeholder:["Search all the GIFs and Stickers","@username to search channels"][s],onEnter:g,autoFocus:n}),a&&(0,r.jsx)(P,{takeover:a})]})},F=g.ZP.div.withConfig({componentId:"sc-ca01e50d-5"})(["",""],(0,b.gv)((0,g.iv)(["position:relative;width:","px;margin:0 auto;"],k.VC)));var G=e=>{let{children:t}=e,n=(0,l.vl)(),o=(0,x.useRouter)(),{user:c}=(0,v.useContext)(y.Z),{hideSearchbar:u}=(0,v.useContext)(i.z),{term:d=""}=(0,x.useParams)(),[f]=(0,a.Rr)(d),{favorites:p}=(0,v.useContext)(s.ZP),[g,k]=(0,v.useState)(""),b=(0,v.useRef)(null),[C,j]=(0,v.useState)(!1);return(0,v.useEffect)(()=>{let e;return b.current&&(e=new IntersectionObserver(e=>{let[t]=e;j(t.intersectionRatio<1)},{threshold:[1],rootMargin:"0px 1000px 1000px 1000px"})).observe(b.current),()=>null==e?void 0:e.disconnect()},[]),(0,r.jsxs)(F,{children:[(0,r.jsx)(L.Provider,{value:{setIgnoreTarget:k,ignoreTarget:g},children:(0,r.jsxs)(h.SearchContextManager,{initialTerm:f,apiKey:n,shouldFetchChannels:!1,theme:{searchbarHeight:68,mobileSearchbarHeight:68},children:[(0,r.jsx)(_,{}),(0,r.jsx)(m.ZP,{user:c,onLogoClick:()=>{o.push("/")},hasFavorites:p.length>0}),(0,r.jsx)(E,{$isStuck:C,children:(0,r.jsx)(w.ZP,{})}),!u&&(0,r.jsx)(N,{ref:b,children:(0,r.jsxs)(B,{$isStuck:C,children:[(0,r.jsx)(O,{isStuck:C}),(0,r.jsx)(Z,{isStuck:C})]})}),t]})}),(0,r.jsx)(I,{})]})}},23042:function(e,t,n){n.d(t,{b:function(){return r}});let r=(0,n(7653).createContext)({takeover:void 0})},14789:function(e,t,n){n.d(t,{c5:function(){return l},k1:function(){return f},xL:function(){return h}});var r=n(27573),o=n(45885),i=n(79122),a=n(7653),c=n(6928);let s=(0,a.createContext)({favorites:[],setFavorites:()=>{},hasChecked:[],setHasChecked:()=>{}}),u=e=>{let{user:t}=(0,a.useContext)(c.Z),n=(0,a.useState)([]),[r,o]=(0,a.useState)(!1),s=(0,a.useRef)(!1),[u,l]=n,h=(0,i.vl)();return(0,a.useEffect)(()=>{if(t){if(!s.current){s.current=!0;let n=window.localStorage.getItem(e);d(n?JSON.parse(n):[],t,e,h)}}else if(r)try{window.localStorage.setItem(e,JSON.stringify(Array.from(new Set(u))))}catch(t){console.error("failed to set ".concat(e," in local"))}else try{let t=window.localStorage.getItem(e);l(t?JSON.parse(t):[]),o(!0)}catch(e){}},[h,r,e,l,u,t]),n},l=e=>{let{children:t}=e,[n,o]=u("local-favorites"),[i,c]=(0,a.useState)([]);return(0,a.useEffect)(()=>{},[]),(0,r.jsx)(s.Provider,{value:{favorites:n,setFavorites:o,hasChecked:i,setHasChecked:c},children:t})};async function d(e,t,n,r){let i=e[0];if(i)try{setTimeout(async()=>{await (0,o.a3)(i,t.token,document.cookie,r),window.localStorage.setItem(n,JSON.stringify(e.filter(e=>e!==i))),d(e.slice(1),t,n,r)},100)}catch(e){console.error("failed to sync favorite ".concat(i),e)}}function h(e){let{user:t}=(0,a.useContext)(c.Z),n=(0,i.vl)(),{favorites:r,setFavorites:u,hasChecked:l,setHasChecked:d}=(0,a.useContext)(s),h=(0,a.useRef)(!1);if((0,a.useEffect)(()=>{async function r(e){if(t){let r=await (0,o.Gs)(e,t.token,n);u(t=>{let n=t.includes(e);return r&&!n?[...t,e]:!r&&n?t.filter(t=>t!==e):t}),d(t=>[...t,e])}}!e||h.current||l.includes(e)||(h.current=!0,r(e))},[n,l,e,u,d,t]),e)return t?l.includes(e)?r.includes(e):void 0:r.includes(e)}function f(){let{user:e}=(0,a.useContext)(c.Z),t=(0,i.vl)(),{favorites:n,setFavorites:r}=(0,a.useContext)(s);return async function(i){let a=n.includes(i);if(e)return a?a&&(await (0,o.Ni)(i,e.token,document.cookie,t),r(e=>e.filter(e=>e!==i))):(await (0,o.a3)(i,e.token,document.cookie,t),r(e=>[...e,i])),!a;a?r(e=>e.filter(e=>e!==i)):r(e=>[...e,i])}}t.ZP=s},40401:function(e,t,n){let r=(0,n(7653).createContext)({route:""});t.Z=r},21447:function(e,t,n){n.d(t,{z:function(){return a}});var r=n(27573),o=n(53603),i=n(7653);let a=(0,i.createContext)({autoFocus:!1});t.Z=e=>{let{children:t}=e,{deviceType:n}=(0,i.useContext)(o.default),[c,s]=(0,i.useState)("desktop"===n);(0,i.useEffect)(()=>{s(!1)},[]);let u=(0,i.useMemo)(()=>({autoFocus:c}),[c]);return(0,r.jsx)(a.Provider,{value:u,children:t})}}}]);
//# sourceMappingURL=897-d424f6c6b6b3ca92.js.map